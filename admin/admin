#*.

Про таинственные переменные для линковщика
При работе с переменными окружения надо юзать не rsh, а rlogin
Ты радостно логинился на машину с rsh и портил записи в .bashrc

#*.
Интересная хреновина - echo "-n" не работает, ничего не выводит
echo "-r", echo "-q" и любая другая буква запросто

#*.
mkdir -p, создавать папки вместе с недостающими родительскими


#*.
Отрицание в регулярных выражениях:
[^%]ggg - начинающееся не с процента

#*.
Как копировать файлы с локальной машины на удалённую, если NFS не подмонтирована
scp anikin_a@hyhus:/home/anikin_a/fir/build.tar.gz.split_ab /tmp/fir_store
подробнее в тут
http://system-administrators.info/?p=649

#*.
Приём для Makefile-ов, можно добавлять строки и не заботиться, есть там в конце _\_ или нет
DIRS = \
  public \
  src \
  $(NULL)

#*.
Копировать, сохраняя структуру каталогов!
cp --parents a/b/file ../patch
результат patch/a/b/file

#*.
Как компилятор заставить видеть заголовки по умолчанию без поезда из инклюдов:
переменные C_INCLUDE_PATH, CPLUS_INCLUDE_PATH - аналоги LD_LIBRARY_PATH

#*.
Как проверить в sh-скрипте, пуст ли первый аргумент.

if [ x$1 == "x" ]

#*.
Как грепом искать текст из бэкслэша? ('\')
Оказывается, это будет grep "\\\\" - так находит единичный \
Понятно, почему - bash интерпретирует первую экранировку, остаётся \\, и grep
интерпретирует вторую экранировку, остаётся \.

#*.
Как сделать удобный прогресс-бар для долгих тестов
Всего лишь tail -f check.log

#*.
Извлечение аргументов в shell-скрипте, быстрое и хитрое

#
# Extract a few options from the option list.
#
verbose=0
debug=""
for a in "$@" ; do
  case $a in
      -v|--v|-verb*|--verb*)    verbose=`expr $verbose + 1`;;
      -D0|--D0)       debug="-D 0" ;;
      -D1|--D1)       debug="-D 1" ;;
  esac
done

#*.
Любознательный вопрос - почему в директорию с правами rwx|r--|r-- от не-владельца зайти нельзя, а с правами rwx|r-x|r-x - можно?
Мы ведь при cd только читаем, не выполняем ничего
Потому что при cd выполняется системный вызов stat, который запрещён, если в директории нельзя ничего выполнять
Копирование такой папки тоже запрещено, кстати

#*.
Как заставить одновременно выводить один и тот же вывод и на экран, и в файл?

Вот так: ls | tee yourfile.ff

#*.
Убийство процесса по имени:
kill -SIGHUP `pidof inetd`

#*.
офигенный поиск библиотек:

locate_library() { [ ! "$1*" = "`echo $1*`" ]; }
find_func() { egrep $1 $2 >/dev/null; }

if find_func hosts_access tcpwrap.o; then
  echo "-lwrap";
  locate_library /lib/libnsl.so && echo "-lnsl";
fi
locate_library /lib/libdl.so && echo "-ldl";
и т.п.

#*. Неожиданно полезное файло с размером
ls -s

#*. 
Команда od - офигенная, название файла в произвольном формате
ls | od -t x1

#*.

Замена sed-ом без заведения временного файла (и без -i)

$ more abc
123456789
23456789
3456789
456789
$ dd if=abc bs=8k | sed -e 's/5/s/g' | dd conv=notrunc of=abc
0+1 records in
0+1 records out
0+1 records in
0+1 records out
$ more abc
1234s6789
234s6789
34s6789
4s6789

#*.

При юзании utf-8 в mount она называется не utf-8, а utf8!
mount -o iocharset=utf8
А точнее, она называется так, как называется твоя системная локаль - а она в дженте 
с какого-то перепугу ru_RU.utf8


#*. Простое чтение слов из строки

echo "string with words" | awk '{print $2}'

#*. Настройка крона

crontab -e
^^^
Составление файла с правилами и затем его установка автоматом

crontab -l
^^^
просмотр текущего файла заданий крона

SHELL=/bin/bash
PATH=/bin:/usr/bin:/usr/X11R6/bin
#MAILTO=
HOME=/home/anikin_a/test/cron
#
01 * * * * /home/anikin_a/test/cron/test.sh

каждую первую минуту любого часа, дня и т.д. выполнять скриптик

Тут обнаружился глюк - раскомментированная строка с пустым MAILTO приводит 
к ошибке синтаксиса в файле крона
если забить мыльник - всё работает

man 5 crontab
^^^
Вместо шаблона со времением можно писать спец-строки:
@daily, @midnight, @hourly и тыды 

#*.
ls -v
^^^
Удобная сортировка "по версиям", выводит в нужном порядке имена вида r10 r9 r8:

r8
r9
r10

#*.
Получить разницу между оригинальной и модифицированной директорией в виде файлового патча

dirOrig='tier'; dirNew='reit'; dirPatch='result' ;
mkdir -p $dirPatch ; diff -q -r $dirNew $dirOrig | \
sed -e "s%Only in $dirNew[\/]\?%%; s/^: //; s%: %\/%" \
-e "s%Files $dirNew\/%%; s/ and.*$//" | \
while read fl ; do [ -f "${dirNew}/$fl" -o -d "${dirNew}/$fl" ] && cp -a --parents ${dirNew}/$fl $dirPatch ; done ; 


#*.
gcc -fverbose-asm -march=native -Q --help=target
^^^
просмотр настроек оптимизаций компилятора

gcc -fverbose-asm -march=native -Q --help=target | grep march
^^^
флаг для тюнинга компиляции точно под свой камень

#*.
tar cfz ./dir
tar cfz dir
^^^
эта гадость различается!!! и распаковывать её надо по-разному!

tar xfz ./dir
tar xfz dir
^^^
соответственно
